<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Synapse App</title>

  <link rel="icon" href="/app/assets/favicon-32.png">
  <link rel="stylesheet" href="/app/app.css?v=4">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>
<body class="synapse-app">

  <!-- Auth Gate -->
  <div id="auth-gate" class="auth-gate">
    <div class="auth-card">
      <div class="logo-text">Synapse</div>
      <p>Teaching tools that feel magical.</p>
      <button type="button" class="btn btn-google" data-action="google-signin">
        <svg aria-hidden="true" width="18" height="18" viewBox="0 0 18 18">
          <path d="M16.51 8.1H9v3h4.3c-.2 1-1.3 3.4-4.3 3.4-2.6 0-4.8-2.2-4.8-4.9s2.2-4.9 4.8-4.9c1.5 0 2.5 1 2.9 1.4l2.2-2.2C14.2 2.5 11.9 1.5 9 1.5c-4.1 0-7.5 3.4-7.5 7.5s3.4 7.5 7.5 7.5c4.4 0 7-3.1 7-7.2 0-.5 0-1-.1-1.4z" fill="#4285F4"></path>
        </svg>
        <span>Sign in with Google</span>
      </button>
      <p id="auth-status" class="auth-status"></p>
    </div>
  </div>

  <!-- Main App -->
  <div id="app-container" class="app-container" hidden>
    <aside class="sidebar">
      <nav>
        <div class="logo-text">Synapse</div>
        <ul class="nav-menu">
          <li><a href="#dashboard" data-tab="dashboard" class="nav-item active"><span>Dashboard</span></a></li>
          <li><a href="#roster" data-tab="roster" class="nav-item"><span>Roster</span></a></li>
          <li><a href="#groups" data-tab="groups" class="nav-item"><span>Groups</span></a></li>
          <li><a href="#assignments" data-tab="assignments" class="nav-item"><span>Assignments</span></a></li>
        </ul>
      </nav>
      <div class="sidebar-footer">
        <div id="user-profile" class="user-profile">
          <img id="user-avatar" alt="User avatar">
          <span id="user-display-name"></span>
        </div>
        <button type="button" class="btn" data-action="sign-out">Sign Out</button>
      </div>
    </aside>

    <main id="app-main" class="app-main">
      <header class="main-header">
        <h1 id="view-title">Dashboard</h1>
        <p id="welcome-message" class="welcome-message"></p>
      </header>

      <section id="view-dashboard" class="view"></section>

      <section id="view-roster" class="view" hidden>
        <div class="card">
          <div class="card-header">
            <h2>Import Roster</h2>
            <p>Upload a .csv or .tsv file to add students.</p>
          </div>
          <div class="controls-grid">
            <select id="roster-quarter" class="input">
              <option>Q1</option><option>Q2</option><option>Q3</option><option>Q4</option>
            </select>
            <select id="roster-period" class="input">
              <option>Period 1</option><option>Period 2</option><option>Period 3</option><option>Period 4</option>
            </select>
            <label class="btn file-input-label" for="roster-file-input">
              Choose File
              <input type="file" id="roster-file-input" accept=".csv,.tsv,.txt" class="visually-hidden">
            </label>
            <button type="button" class="btn btn-brand" data-action="save-roster">Import Students</button>
          </div>
          <p id="roster-upload-status" class="status-text"></p>
        </div>
        <div class="card">
          <div class="card-header"><h2>Current Roster</h2></div>
          <div id="roster-table-container" class="table-container"></div>
        </div>
      </section>

      <section id="view-groups" class="view" hidden>
        <div class="card">
          <div class="card-header">
            <h2>Create Student Groups</h2>
            <p>Generate groups based on roster data.</p>
          </div>
          <div class="controls-grid">
            <select id="groups-period" class="input"></select>
            <select id="groups-strategy" class="input">
              <option value="heterodox">Heterogeneous (Mixed)</option>
              <option value="homogeneous">Homogeneous (Similar)</option>
            </select>
            <select id="groups-size" class="input"><option>3</option><option>4</option><option>5</option></select>
            <button type="button" class="btn btn-brand" data-action="generate-groups">Generate Groups</button>
          </div>
        </div>
        <div id="groups-container" class="groups-grid"></div>
      </section>

      <section id="view-assignments" class="view" hidden>
        <div class="card">
          <div class="card-header">
            <h2>Assignment Generator</h2>
            <p>Create a standards-aligned resource with AI.</p>
          </div>
          <div class="assignment-generator-grid">
            <div class="standards-picker">
              <h3>1. Select a Standard</h3>
              <select id="standards-subject" class="input"></select>
              <select id="standards-grade" class="input" disabled></select>
              <input type="search" id="standards-search" class="input" placeholder="Search standards..." disabled>
              <div id="standards-list" class="standards-list"></div>
            </div>
            <div class="generator-controls">
              <h3>2. Set Options</h3>
              <label for="assignment-level">Level</label>
              <select id="assignment-level" class="input">
                <option>On Grade Level</option><option>Remedial</option><option>Advanced</option>
              </select>
              <label for="assignment-duration">Duration</label>
              <select id="assignment-duration" class="input">
                <option>60 min Lesson</option><option>90 min Block</option><option>Multi-day Unit</option>
              </select>
              <button type="button" id="generate-assignment-btn" class="btn btn-brand" data-action="generate-assignment" disabled>Generate</button>
            </div>
          </div>
        </div>
        <div id="assignment-output" class="card" hidden></div>
      </section>
    </main>
  </div>

  <div id="toaster" class="toaster"></div>
  <div id="crash-overlay" class="crash-overlay" hidden>
    <div class="crash-card">
      <h2>Oops! Something went wrong.</h2>
      <p>Please refresh the page.</p>
      <pre id="error-details" class="error-details"></pre>
    </div>
  </div>

  <script type="module" src="/app/app.js?v=4"></script>
</body>
</html>
